(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){e.exports=a(43)},23:function(e,t,a){},25:function(e,t,a){},27:function(e,t,a){},29:function(e,t,a){},35:function(e,t,a){},37:function(e,t,a){},39:function(e,t,a){},41:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(14),i=a.n(o),r=(a(23),a(17)),c=a(16),l=a(6),u=a(7),d=a(10),h=a(8),m=a(9),p=a(2),f=(a(25),a(27),function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"onScriptLoad",value:function(){var e=new window.google.maps.Map(document.getElementById(this.props.id),this.props.options);this.props.mapLoad(e)}},{key:"componentDidMount",value:function(){var e=this;if(window.google)this.onScriptLoad();else{var t=document.createElement("script");t.src="https://maps.google.com/maps/api/js?key=AIzaSyALa3cDehIN5lKkIcA0yeOwx_cUil_AWK4",t.async=!0,t.defer=!0,t.addEventListener("load",function(t){e.onScriptLoad()});var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(t,a)}}},{key:"render",value:function(){return s.a.createElement("div",{className:"map",id:this.props.id,role:"application","aria-label":"M\xfcnster City Map"})}}]),t}(n.Component)),v=(a(29),a(15)),w=a(3),g=function(e){var t="toolbar-logo",a="toolbar-search-input",n="toolbar-search-icon";return e.showSearch&&(a="toolbar-search-input open",t="toolbar-logo close",n="toolbar-search-icon close"),s.a.createElement("header",{className:"toolbar"},s.a.createElement("nav",{className:"toolbar-navigation"},s.a.createElement("button",{"aria-label":"Side Menu",className:"toolbar-menu",onClick:e.drawerClickHandler},s.a.createElement(w.a,{icon:"bars"})),s.a.createElement("div",{className:t},s.a.createElement("h1",null,"M\xfcnster City Map")),s.a.createElement("div",{className:"spacer"}),s.a.createElement("button",{"aria-label":"open search input",className:n,onClick:e.display},s.a.createElement(w.a,{icon:"search"})),s.a.createElement(v.DebounceInput,{className:a,placeholder:"Search",autoFocus:!0,minLength:2,debounceTimeout:300,"aria-label":"Search by name",onChange:function(t){return e.search(t.target.value)},value:e.query})))},b=(a(35),function(e){var t="toast";return e.show&&(t="toast visible"),s.a.createElement("div",{className:t,role:"alert"},s.a.createElement(w.a,{icon:"exclamation-triangle"}),s.a.createElement("p",null,e.message))}),k=(a(37),function(e){var t="side-drawer";e.show&&(t="side-drawer open");return s.a.createElement("nav",{className:t,tabIndex:"0"},[{name:"restaurants",id:"4bf58dd8d48988d1c4941735",label:"Restaurants",icon:"utensils"},{name:"nightlife",id:"4d4b7105d754a06376d81259",label:"Nightlife",icon:"cocktail"},{name:"outdoor",id:"4d4b7105d754a06377d81259",label:"Outdoor",icon:"sun"},{name:"travel",id:"4d4b7105d754a06379d81259",label:"Travel",icon:"suitcase"},{name:"informationCenter",id:"4f4530164b9074f6e4fb00ff",label:"Information Center",icon:"info-circle"}].map(function(t){return t.name===e.category?s.a.createElement("button",{className:"options-button clicked",onClick:function(){return e.searchByCategory(t.id,t.name)},key:t.id,"aria-label":t.label},s.a.createElement(w.a,{className:"side-drawer-icons",icon:t.icon}),t.label):s.a.createElement("button",{className:"options-button",onClick:function(){return e.searchByCategory(t.id,t.name)},key:t.id,"aria-label":t.label},s.a.createElement(w.a,{className:"side-drawer-icons",icon:t.icon}),t.label)}),s.a.createElement("div",{className:"foursquare"},s.a.createElement("a",{href:"https://de.foursquare.com/","aria-label":"Powered by foursquare"},"Powered by ",s.a.createElement(w.a,{className:"foursquare-icon",icon:["fab","foursquare"]}))))}),y=(a(39),function(e){return s.a.createElement("div",{className:"backdrop",onClick:e.click})}),C=(a(41),function(e){var t="search-list";return e.show&&(t="search-list open"),s.a.createElement("nav",{className:t,tabIndex:"0"},s.a.createElement("ul",{tabIndex:"0"},e.values.map(function(t){return s.a.createElement("li",{role:"button",key:t.venue.id,onKeyPress:function(){return e.handleListClick(t.venue.id)},onClick:function(){return e.handleListClick(t.venue.id)}},t.venue.name)})))}),S=a(5),E=a(11),L=a(4),O="WCSYL05LCDFT1FZUPPCKTTTAGXHIJW35BSM0ZB2ASSN1AS30",N="XWO5JGWXXJCJEBHAGHIQEAPCD02Y5THUQLZDLLG1NJW2RUKU",T=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).mapLoad=a.mapLoad.bind(Object(p.a)(Object(p.a)(a))),a.configInfoWindow=a.configInfoWindow.bind(Object(p.a)(Object(p.a)(a))),a.handleListClick=a.handleListClick.bind(Object(p.a)(Object(p.a)(a))),a.drawerToggleClickHandler=a.drawerToggleClickHandler.bind(Object(p.a)(Object(p.a)(a))),a.backdropDrawer=a.backdropDrawer.bind(Object(p.a)(Object(p.a)(a))),a.backdropList=a.backdropList.bind(Object(p.a)(Object(p.a)(a))),a.handleSearchByName=a.handleSearchByName.bind(Object(p.a)(Object(p.a)(a))),a.searchByCategory=a.searchByCategory.bind(Object(p.a)(Object(p.a)(a))),a.listDisplayHandler=a.listDisplayHandler.bind(Object(p.a)(Object(p.a)(a))),a.state={venuesByCategories:{},venues:[],showVenues:[],details:[],markers:[],map:null,sideDrawerOpen:!1,infoWindow:null,showList:!1,query:"",category:"restaurants",showToast:!1,msgToast:""},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"mapLoad",value:function(e){this.setState({map:e,infoWindow:new window.google.maps.InfoWindow({maxWidth:350,maxHeight:400})}),this.searchByCategory("4bf58dd8d48988d1c4941735","restaurants")}},{key:"handleRequestErrors",value:function(e){if(!e.ok)throw console.log(e),Error(e.status);return e.json()}},{key:"handleToasts",value:function(e){e.toString().includes("403")?this.showToast("Unable to responde! Daily Limit Reached"):e.toString().includes("500")?this.showToast("Unable to connect with Server! Please try again"):e.toString().includes("Failed to fetch")?this.showToast("Please check your Internet Connection"):this.showToast("Error! Please try again")}},{key:"showToast",value:function(e){var t=this;this.setState({showToast:!0,msgToast:e},function(){setTimeout(function(){return t.setState({showToast:!1})},3500)})}},{key:"orderVenues",value:function(e){return(e=e.map(function(e){var t=e.venue.name;return e.venue.name=t.charAt(0).toUpperCase()+t.slice(1),e})).sort(function(e,t){return e.venue.name<=t.venue.name?-1:1}),this.setState({venues:e,showVenues:e}),e}},{key:"createMarkers",value:function(){var e=this,t=new window.google.maps.LatLngBounds,a=this.state.map,n=this.state.venues.map(function(n){var s=new window.google.maps.Marker({position:{lat:n.venue.location.lat,lng:n.venue.location.lng},map:a,animation:window.google.maps.Animation.DROP,title:n.venue.name,id:n.venue.id});return t.extend(s.position),s.addListener("click",function(){e.configInfoWindow(s,n.venue)}),s});a.fitBounds(t),this.setState({markers:n,map:a})}},{key:"clearMarkers",value:function(){var e=this.state.markers.slice();e=e.map(function(e){return e.setMap(null),e}),this.setState({markers:e})}},{key:"deleteMarkers",value:function(){this.clearMarkers(),this.setState({markers:[]})}},{key:"reloadMarkers",value:function(){this.deleteMarkers();var e=this;setTimeout(function(){e.createMarkers()},0)}},{key:"handleListClick",value:function(e){this.backdropList(),this.clearMarkers();var t,a=this.state.markers.slice();for(t=0;t<a.length&&a[t].id!==e;t++);if(t<a.length){a[t].setMap(this.state.map),this.setState({markers:a});var n=this.state.venues.find(function(t){return t.venue.id===e});this.configInfoWindow(a[t],n.venue)}}},{key:"handleSearchByName",value:function(e){if(""===e)this.setState({showVenues:this.state.venues,query:""});else{var t=this.state.showVenues.slice();t=t.filter(function(t){var a=t.venue.name.toUpperCase(),n=e.toUpperCase();return a.includes(n)}),this.setState({showVenues:t,query:e})}this.showSelectedMarkers()}},{key:"showSelectedMarkers",value:function(){var e=this,t=this.state.infoWindow;t.close(),this.setState({infoWindow:t});var a=this.state.markers.slice(),n=this.state.showVenues.slice();a=a.map(function(t){return n.find(function(e){return e.venue.id===t.id?e:null})?t.setMap(e.state.map):t.setMap(null),t}),this.setState({markers:a})}},{key:"showAllMarkers",value:function(){var e=this,t=this.state.infoWindow;t.close(),this.setState({infoWindow:t});var a=this.state.markers.slice();a.filter(function(e){return null===e.getMap()}).length>0?(a=a.map(function(t){return t.setMap(e.state.map),t}),this.setState({markers:a,showVenues:this.state.venues,query:""})):this.setState({query:""})}},{key:"configInfoWindow",value:function(e,t){var a=this,n=this.state.infoWindow;n.close(),n.setContent(""),n.marker=e,n.addListener("closeclick",function(){n.setMarker=null});var s=this.state.details.find(function(e){return e.id===t.id});if(s)this.setContentInfoWindow(n,s),e.setAnimation(window.google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null),n.open(e.map,e)},1200),this.setState({infoWindow:n});else{var o=new URL("https://api.foursquare.com/v2/venues/".concat(t.id));o.search=new URLSearchParams({client_id:O,client_secret:N,v:"20181025",locale:"en"}),fetch(o).then(this.handleRequestErrors).then(function(e){a.setState(function(t){return{details:Object(c.a)(t.details).concat([e.response.venue])}}),a.setContentInfoWindow(n,e.response.venue)}).catch(function(t){a.handleToasts(t),e.setAnimation(window.google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1200)})}}},{key:"setContentInfoWindow",value:function(e,t,a){var n="";if(t){var s="";if(s=t.bestPhoto?t.bestPhoto.prefix+"208x120"+t.bestPhoto.suffix:"https://via.placeholder.com/208x120.png?text=No+Image",n="<div class='info-window'>\n                 <img src=".concat(s," alt='").concat(t.name," provided by foursquare'>\n                 <h2>").concat(t.name,"</h2>"),t.categories&&(n+="<p>".concat(t.categories[0].shortName,"</p>")),t.location.address&&(n+="<p>".concat(t.location.address,"</p>")),t.contact.phone&&(n+="<p>".concat(t.contact.phone,"</p>")),t.hours){var o=t.hours.timeframes;n+="<div class='opening'>",n+="<p class='opening-title'><strong >".concat(t.hours.status,"</strong></p>"),o.forEach(function(e){n+="<p class='opening-days'>".concat(e.days,"</p>\n      <p class='opening-hours'>").concat(e.open[0].renderedTime,"</p>")}),n+="</div>"}n+="</div>"}else n+="<div class='info-window'><p>".concat(a,"</p></div>");e.setContent(n)}},{key:"drawerToggleClickHandler",value:function(){this.setState(function(e){return{sideDrawerOpen:!e.sideDrawerOpen}}),this.setState({showList:!1}),this.showAllMarkers()}},{key:"backdropDrawer",value:function(){this.setState({sideDrawerOpen:!1})}},{key:"backdropList",value:function(){this.setState({showList:!1,query:""})}},{key:"listDisplayHandler",value:function(){this.setState({showList:!0,sideDrawerOpen:!1,showVenues:this.state.venues}),this.showAllMarkers()}},{key:"searchByCategory",value:function(e,t){var a=this;if(this.setState({query:"",showList:!1,category:t,sideDrawerOpen:!1}),this.state.venuesByCategories.hasOwnProperty(t)&&0!==this.state.venuesByCategories[t].length)this.setState({venues:this.state.venuesByCategories[t],showVenues:this.state.venuesByCategories[t],category:t}),this.reloadMarkers();else{var n=Object(r.a)({},this.state.venuesByCategories);n[t]=[];var s=new URL("https://api.foursquare.com/v2/venues/explore?");s.search=new URLSearchParams({client_id:O,client_secret:N,near:"M\xfcnster",categoryId:e,v:"20181025",radius:"3000"}),fetch(s).then(this.handleRequestErrors).then(function(e){var s=a.orderVenues(e.response.groups[0].items);a.deleteMarkers(),a.createMarkers(),n[t]=s,a.setState({venuesByCategories:n})}).catch(function(e){a.handleToasts(e)})}}},{key:"render",value:function(){var e;return this.state.sideDrawerOpen&&(e=s.a.createElement(y,{click:this.backdropDrawer})),this.state.showList&&(e=s.a.createElement(y,{click:this.backdropList})),s.a.createElement("div",{className:"App"},s.a.createElement(g,{drawerClickHandler:this.drawerToggleClickHandler,search:this.handleSearchByName,query:this.state.query,display:this.listDisplayHandler,showSearch:this.state.showList}),s.a.createElement(k,{show:this.state.sideDrawerOpen,searchByCategory:this.searchByCategory,category:this.state.category}),e,s.a.createElement("main",null,s.a.createElement(C,{values:this.state.showVenues,handleListClick:this.handleListClick,show:this.state.showList}),s.a.createElement(f,{id:"map",options:{center:{lat:51.961773,lng:7.621385},zoom:14,mapTypeControl:!1},mapLoad:this.mapLoad}),s.a.createElement(b,{show:this.state.showToast,message:this.state.msgToast})))}}]),t}(n.Component);S.b.add(E.b,L.g,L.f,L.b,L.h,L.d,L.e,L.a,L.c,E.a);var j=T,M=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function B(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(s.a.createElement(j,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/neighborhood-map",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/neighborhood-map","/service-worker.js");M?(function(e,t){fetch(e).then(function(a){404===a.status||-1===a.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):B(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):B(t,e)})}}()}},[[18,2,1]]]);
//# sourceMappingURL=main.a2650236.chunk.js.map